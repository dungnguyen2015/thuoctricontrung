(()=>{var e={};e.id=990,e.ids=[990],e.modules={62849:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=62849,e.exports=t},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},98216:e=>{"use strict";e.exports=require("net")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},95346:e=>{"use strict";e.exports=require("timers")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},85573:(e,t,s)=>{"use strict";s.r(t),s.d(t,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>E,routeModule:()=>d,serverHooks:()=>v,staticGenerationAsyncStorage:()=>x});var r={};s.r(r),s.d(r,{GET:()=>p,POST:()=>l});var i=s(49303),o=s(88716),n=s(60670),a=s(87070),u=s(21124),c=s(9487);async function p(e){let{searchParams:t}=new URL(e.url),s=parseInt(t.get("page")||"1"),r=await (0,u.Jq)(s),i=await (0,u.eU)();return a.NextResponse.json({posts:r,total:i})}async function l(e){let{title:t,slug:s,content:r,image_url:i,visible:o,description:n}=await e.json(),u=`
    INSERT INTO posts (title, slug, content, image_url, visible, description)
    VALUES (?, ?, ?, ?, ?, ?)
  `,p=await (0,c.I)(u,[t,s,r,i,o,n]);return p&&1===p.affectedRows?a.NextResponse.json({success:!0,message:"Created",id:p.insertId}):a.NextResponse.json({success:!1})}let d=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/posts/route",pathname:"/api/posts",filename:"route",bundlePath:"app/api/posts/route"},resolvedPagePath:"D:\\VPS-Dung\\thuoctricontrung\\app\\api\\posts\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:E,staticGenerationAsyncStorage:x,serverHooks:v}=d,f="/api/posts/route";function h(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:x})}},46643:(e,t,s)=>{"use strict";s.d(t,{w:()=>o});var r=s(9487);let i=new Map,o=async(e,t,s,o=3e5)=>{if(i.has(e))return i.get(e);let n=await (0,r.I)(t,s);return i.set(e,n),n}},9487:(e,t,s)=>{"use strict";s.d(t,{I:()=>i,db:()=>r});let r=s(69518).createPool({host:process.env.DB_HOST||"localhost",user:process.env.DB_USER||"root",password:process.env.DB_PASS||"",database:process.env.DB_NAME||"trungdienlanh",waitForConnections:!0,connectionLimit:20,queueLimit:100,enableKeepAlive:!0,keepAliveInitialDelay:3e4});async function i(e,t){{let[s]=await r.execute(e,t);return s}}},21124:(e,t,s)=>{"use strict";s.d(t,{Jq:()=>n,TI:()=>u,Vk:()=>c,eU:()=>a,zQ:()=>o});var r=s(9487),i=s(46643);async function o(e){try{let t=await (0,i.w)(`post_${e}`,"SELECT * FROM posts WHERE slug = ? AND visible = 1",[e],3e4);return t.length>0?t[0]:null}catch(e){return console.error("Lỗi truy vấn b\xe0i viết:",e),null}}async function n(e,t=6){let s=(e-1)*t,i=`SELECT * FROM posts WHERE visible = 1 ORDER BY created_at DESC LIMIT ${t} OFFSET ${s}`;if(isNaN(t)||isNaN(s))throw Error("limit hoặc offset kh\xf4ng hợp lệ");return await (0,r.I)(i)}async function a(){let[e]=await (0,r.I)("SELECT COUNT(*) as count FROM posts WHERE visible = 1");return e[0].count}let u=(0,s(57708).unstable_cache)(async()=>{try{let e=await (0,r.I)(`
        SELECT COUNT(id) as total 
        FROM posts USE INDEX (status_created_at_idx)
        WHERE visible = 1
      `);return e[0]?.total||0}catch(e){return console.error("Failed to fetch article count:",e),0}},["total-posts"],{tags:["posts"],revalidate:3600});async function c(e,t){let s=(e-1)*t,r=`SELECT * FROM posts WHERE visible = 1 ORDER BY created_at DESC LIMIT ${t} OFFSET ${s}`;try{return await (0,i.w)(`posts_list_${e}_${t}`,r)||[]}catch(e){return console.error("Chi tiết lỗi:",{error:e,queryParams:{limit:t,offset:s},types:{limit:typeof t,offset:typeof s}}),[]}}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,827,972,708],()=>s(85573));module.exports=r})();